<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">

<script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
<link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-32.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="[toc] 目录canvas 概述：H5新增双闭合标签，它主要的功能是可以让我们写一些小游戏。 资料：API、手册一. canvas的基本使用1234567891011&amp;lt;head&amp;gt;    &amp;lt;meta charset=&amp;quot;UTF-8&amp;quot;&amp;gt;    &amp;lt;title&amp;gt;Document&amp;lt;/title&amp;gt;    &amp;lt;style&amp;gt;">
<meta property="og:type" content="article">
<meta property="og:title" content="爱前端笔记">
<meta property="og:url" content="KevinBlack.github.io/8d969c4d.html">
<meta property="og:site_name" content="♠♥♣♦">
<meta property="og:description" content="[toc] 目录canvas 概述：H5新增双闭合标签，它主要的功能是可以让我们写一些小游戏。 资料：API、手册一. canvas的基本使用1234567891011&amp;lt;head&amp;gt;    &amp;lt;meta charset=&amp;quot;UTF-8&amp;quot;&amp;gt;    &amp;lt;title&amp;gt;Document&amp;lt;/title&amp;gt;    &amp;lt;style&amp;gt;">
<meta property="og:image" content="KevinBlack.github.io/img/aiqianduan/WX20200318-174327@2x.png">
<meta property="og:image" content="KevinBlack.github.io/img/aiqianduan/WX20200318-174409@2x.png">
<meta property="og:image" content="KevinBlack.github.io/img/aiqianduan/WX20200318-174421@2x.png">
<meta property="og:image" content="KevinBlack.github.io/img/aiqianduan/WX20200318-174432@2x.png">
<meta property="og:image" content="KevinBlack.github.io/img/aiqianduan/WX20200318-174448@2x.png">
<meta property="og:image" content="KevinBlack.github.io/img/aiqianduan/WX20200318-174502@2x.png">
<meta property="og:image" content="KevinBlack.github.io/img/aiqianduan/WX20200318-174539@2x.png">
<meta property="og:image" content="KevinBlack.github.io/img/aiqianduan/WX20200318-174550@2x.png">
<meta property="og:updated_time" content="2020-03-18T09:56:49.376Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="爱前端笔记">
<meta name="twitter:description" content="[toc] 目录canvas 概述：H5新增双闭合标签，它主要的功能是可以让我们写一些小游戏。 资料：API、手册一. canvas的基本使用1234567891011&amp;lt;head&amp;gt;    &amp;lt;meta charset=&amp;quot;UTF-8&amp;quot;&amp;gt;    &amp;lt;title&amp;gt;Document&amp;lt;/title&amp;gt;    &amp;lt;style&amp;gt;">
<meta name="twitter:image" content="KevinBlack.github.io/img/aiqianduan/WX20200318-174327@2x.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":true},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="KevinBlack.github.io/8d969c4d.html"/>





  <title>爱前端笔记 | ♠♥♣♦</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">♠♥♣♦</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-resume">
          <a href="/resume" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            简历
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="KevinBlack.github.io/8d969c4d.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="万俟逍">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="♠♥♣♦">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">爱前端笔记</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-03-18T00:00:00+08:00">
                2020-03-18
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/前端知识/" itemprop="url" rel="index">
                    <span itemprop="name">前端知识</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/前端知识/笔记/" itemprop="url" rel="index">
                    <span itemprop="name">笔记</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/前端知识/笔记/爱前端/" itemprop="url" rel="index">
                    <span itemprop="name">爱前端</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  9,057
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  41
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>[toc]</p>
<h1 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h1><h2 id="canvas"><a href="#canvas" class="headerlink" title="canvas"></a>canvas</h2><ul>
<li>概述：H5新增双闭合标签，它主要的功能是可以让我们写一些小游戏。</li>
<li>资料：<a href="https://www.canvasapi.cn" target="_blank" rel="noopener">API</a>、<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Canvas_API/Tutorial/Basic_usage" target="_blank" rel="noopener">手册</a><h3 id="一-canvas的基本使用"><a href="#一-canvas的基本使用" class="headerlink" title="一. canvas的基本使用"></a>一. canvas的基本使用</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;Document&lt;/title&gt;</span><br><span class="line">    &lt;style&gt;</span><br><span class="line">        * &#123; margin: 0; padding: 0;&#125;</span><br><span class="line">        canvas &#123; border: 1px solid black;&#125;</span><br><span class="line">    &lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;canvas width=&quot;600px&quot; height=&quot;300px&quot;&gt;&lt;/canvas&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<blockquote>
<p>注意：canvas有默认的宽和高(300*150px)，如果要改宽高，只能在行间样式中修改！canvas最终相当于是一张图片</p>
</blockquote>
<ol>
<li>canvas绘制基本图形<br>如果想在canvas上绘制图形，需要使用canvas2D上下文； </li>
</ol>
<h2 id="nodeJS"><a href="#nodeJS" class="headerlink" title="nodeJS"></a>nodeJS</h2><h3 id="开门注"><a href="#开门注" class="headerlink" title="开门注"></a>开门注</h3><p><a href="https://nodejs.org/en/" target="_blank" rel="noopener">官网</a>介绍：</p>
<ul>
<li>Node.js是一个构建在Chrome浏览器V8引擎上的JavaScript运行环境；</li>
<li>Node.js使用了事件驱动、非阻塞I/O模型，这些都使它轻量、好用；</li>
<li>Node.js的包生态(npm)，是世界上最大的开源生态系统。</li>
</ul>
<h4 id="1-JavaScript到底出了什么问题？"><a href="#1-JavaScript到底出了什么问题？" class="headerlink" title="1. JavaScript到底出了什么问题？"></a>1. JavaScript到底出了什么问题？</h4><p>先说说异步I/O和同步I/O：绝大多数的网站I/O是非常多的，I就是input(数据的读取)，O就是output(数据的写入)，但I/O的时候CPU命令磁盘去做事情，此时CPU就闲置了。这种模式叫做同步I/O</p>
<ul>
<li>同步(synchronous)：当系统遇见了一个需要耗费大量时间的事情时，选择死等。</li>
<li>异步(Asynchronous)：当系统遇见了一个需要耗费大量时间的事情时，不死等，先做后面的时期，耗时事情做完之后，执行回调函数。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">var fs = require(&quot;fs&quot;);</span><br><span class="line"></span><br><span class="line">fs.readFile(&quot;./test.txt&quot;, function(err, data)&#123;</span><br><span class="line">    console.log(data.toString()); // 后输出</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">var sum = 0;</span><br><span class="line">for(var i=0; i&lt;=100; i++)&#123;</span><br><span class="line">    sum += i;</span><br><span class="line">&#125;</span><br><span class="line">console.log(sum); // 先输出</span><br></pre></td></tr></table></figure>
</li>
</ul>
<blockquote>
<p>Node.js解决性能问题使用非常极端的思想：预期一堆服务员闲着，还不如一个服务员往死里用。</p>
</blockquote>
<h4 id="2-Node-js创建服务器-node-js"><a href="#2-Node-js创建服务器-node-js" class="headerlink" title="2. Node.js创建服务器(node.js)"></a>2. Node.js创建服务器(node.js)</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">// 读取内置模块http，这个模块是开发服务器用的</span><br><span class="line">var http = require(&quot;http&quot;);</span><br><span class="line">// 创建一个服务器</span><br><span class="line">var server = http.createServer(function (req, res) &#123;</span><br><span class="line">    // req表示请求，res表示响应</span><br><span class="line">    // 设置下行请求的头部信息(否则会出现乱码)</span><br><span class="line">    res.setHeader(&quot;Content-Type&quot;, &quot;text/html;charset=UTF-8&quot;);</span><br><span class="line">    // 每个服务器都必须有一个end，即使为空！否则页面会一直处于loading状态，end里面必须是字符串或者二进制</span><br><span class="line">    res.end(&quot;&lt;h1&gt;我买了iPhone&quot; + (3 + 4) + &quot;&lt;/h1&gt;&quot;)</span><br><span class="line">&#125;);</span><br><span class="line">// 监听</span><br><span class="line">server.listen(3000);</span><br></pre></td></tr></table></figure>
<p>运行：在文件所在目录下打开终端，使用下面的命令<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node node.js</span><br></pre></td></tr></table></figure></p>
<p>Node.js是一个让JavaScript运行在服务器端的开发平台，它让JavaScript的触角伸到了服务器端。但Node.js似乎和其他服务端语言比如PHP、ASP、JSP有点不同：</p>
<ul>
<li>Node.js不是一种独立的语言，与PHP、JSP、Python、Ruby的“既是语言，也是平台”不同，Node.js使用JavaScript进行编程，运行在JavaScript引擎上(V8)</li>
<li>与PHP、JSP等相比，Node.js跳过了Apache、Nginx、IIS等HTTP服务器，它自己不用建设在任何服务器软件之上。Node.js的许多设计理念与经典架构(LAMP)有着很大的不同，可以提供强大的伸缩能力.</li>
<li>Node.js自身哲学，就是花最小的硬件成本，追求更高的并发，更高的处理性能。</li>
<li>Node.js没有根目录的概念。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">graph LR</span><br><span class="line">A(浏览器) --&gt;|1.发送request请求|B[服务器2.nodejs程序在这里执行]</span><br><span class="line">B[服务器:2.nodejs程序在这里执行] --&gt;|3.返回response响应|A(浏览器)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="3-Node-js的特点："><a href="#3-Node-js的特点：" class="headerlink" title="3. Node.js的特点："></a>3. Node.js的特点：</h4><ul>
<li>单线程特性<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">var http = require(&quot;http&quot;);</span><br><span class="line">var a = 0;</span><br><span class="line">var server = http.createServer(function (req, res) &#123;</span><br><span class="line">    a++;</span><br><span class="line">    res.setHeader(&quot;Content-Type&quot;, &quot;text/html;charset=UTF-8&quot;);</span><br><span class="line">    // 每个服务器都必须有一个end，即使为空！否则页面会一直处于loading状态，end里面必须是字符串或者二进制</span><br><span class="line">    res.end(a.toString());</span><br><span class="line">&#125;);</span><br><span class="line">// 监听</span><br><span class="line">server.listen(3000);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>每次刷新a都会自增，说明没有新开进程，证明Node.js是单线程的</p>
<blockquote>
<p>Node.js拥有JS的所有核心语法，包括ES6语法。但是Node.js没有BOM的东西，比如window对象等。</p>
</blockquote>
<p>下面的程序一旦刷到6666，将抛出错误，然后程序会挂起，不能再被访问！侧面证明了Node.js是单线程的！<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">var http = require(&quot;http&quot;);</span><br><span class="line"></span><br><span class="line">var server = http.createServer(function (req, res) &#123;</span><br><span class="line">    var num = parsInt(Math.random() * 1000)</span><br><span class="line">    if(num === 6666)&#123;</span><br><span class="line">        throw new Error(&quot;错误！6666出现了！这个人的ip是&quot; + req.connection.remoteAddress);</span><br><span class="line">    &#125;</span><br><span class="line">    res.end(&quot;你的数字是&quot; + num);</span><br><span class="line">&#125;);</span><br><span class="line">// 监听</span><br><span class="line">server.listen(3000);</span><br></pre></td></tr></table></figure></p>
<ul>
<li>异步I/O特性：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">var http = require(&quot;http&quot;); // 创建服务器用的</span><br><span class="line">var fs = require(&quot;fs&quot;); // 读取文件用的</span><br><span class="line"></span><br><span class="line">var ip = req.connection.remoteAddress;</span><br><span class="line">console.log(ip + &quot;来了！开始读取文件！&quot;);</span><br><span class="line"></span><br><span class="line">var server = http.createServer(function (req, res) &#123;</span><br><span class="line">    // 来客人之后做的事情</span><br><span class="line">    fs.readFile(&quot;./test.txt&quot;, function(err, data)&#123;</span><br><span class="line">       res.end(data); </span><br><span class="line">       console.log(ip + &quot;读取文件完毕！&quot;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line">// 监听</span><br><span class="line">server.listen(3000);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>可以看到一个ip开始读到读完之间，会插入别的ip开始读的情况！这就是异步I/O。==只要I/O越多，Node.js宏观上越并行==<br><img src="img/aiqianduan/WX20200318-174327@2x.png" alt="wx20200312-140205@2x.png"><br>而如果==计算越多，Node.js宏观上越不并行==，CPU将被某个线程单独占用！<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">var http = require(&quot;http&quot;); // 创建服务器用的</span><br><span class="line">var fs = require(&quot;fs&quot;); // 读取文件用的</span><br><span class="line"></span><br><span class="line">var ip = req.connection.remoteAddress;</span><br><span class="line">console.log(ip + &quot;来了！开始计算水仙花数！&quot;);</span><br><span class="line">for(var i=1000; i&lt;=9999; i++)&#123;</span><br><span class="line">    var ge = i % 10,</span><br><span class="line">        shi = parsInt(i / 10) % 10,</span><br><span class="line">        bai = parsInt(i / 100) % 10,</span><br><span class="line">        qian = parsInt(i / 1000) % 10;</span><br><span class="line">    var sum = Math.pow(ge,4) + Math.pow(shi,4) + Math.pow(bai,4) + Math.pow(qian,4);</span><br><span class="line">    if(sum == i)&#123;</span><br><span class="line">        console.log(ip + &quot;算出了水仙花数！&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">console.log(ip + &quot;开始读取文件！&quot;);</span><br><span class="line">var server = http.createServer(function (req, res) &#123;</span><br><span class="line">    // 来客人之后做的事情</span><br><span class="line">    fs.readFile(&quot;./test.txt&quot;, function(err, data)&#123;</span><br><span class="line">       res.end(data); </span><br><span class="line">       console.log(ip + &quot;读取文件完毕！&quot;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line">// 监听</span><br><span class="line">server.listen(3000);</span><br></pre></td></tr></table></figure></p>
<p><img src="img/aiqianduan/WX20200318-174409@2x.png" alt="wx20200312-140924@2x.png"></p>
<blockquote>
<p>Node.js适合I/O多的业务，例如：用户表单收集、考试系统、打分系统、聊天室、图文直播、提供JSON的API(为前台Angular等使用)……而不适合计算多的业务！</p>
</blockquote>
<p><img src="img/aiqianduan/WX20200318-174421@2x.png" alt="wx20200312-141558@2x.png"></p>
<ul>
<li>事件驱动特性：事件驱动是Node.js的底层机制，我们只需要了解Node.js不会“上错菜”的原因就是事件驱动——事件环。事件环保证了Node.js可以高效准确的运行而不会紊乱。<br><img src="img/aiqianduan/WX20200318-174432@2x.png" alt="wx20200312-142532@2x.png"></li>
</ul>
<h4 id="4-路由机制"><a href="#4-路由机制" class="headerlink" title="4. 路由机制"></a>4. 路由机制</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">var http = require(&quot;http&quot;); </span><br><span class="line"></span><br><span class="line">var server = http.createServer(function (req, res) &#123;</span><br><span class="line">// 如果要根据用户访问的不同地址呈现不同显示，此时需要用req的url属性来进行判断</span><br><span class="line">    if(req.url == &quot;/&quot;)&#123;</span><br><span class="line">        res.end(&quot;首页&quot;); </span><br><span class="line">    &#125;else if(req.url == &quot;/music.html&quot;)&#123; // 实际上不存在这个页面，但只要输入这个路径，就会显示下面的内容，甚至路径可以伪装成任何样子</span><br><span class="line">        res.end(&quot;音乐频道&quot;); </span><br><span class="line">    &#125;else if(req.url == &quot;/news&quot;)&#123;</span><br><span class="line">        res.end(&quot;新闻频道&quot;); </span><br><span class="line">    &#125;else &#123;</span><br><span class="line">        res.end(&quot;没有这个页面&quot;); </span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line">// 监听</span><br><span class="line">server.listen(3000);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Node.js是没有像Apache那种真实物理文件映射关系的！这叫做顶层路由设计。能够制作顶层路由设计的语言目前比较流行的只有Node.js和Python</p>
</blockquote>
<h4 id="5-模块"><a href="#5-模块" class="headerlink" title="5. 模块"></a>5. 模块</h4><p><strong>url模块、path模块、querystring模块</strong></p>
<blockquote>
<p>一个完整的URL包括querystring部分(就是GET请求查询字符串)、甚至hash部分。但req.url不包括hash(hash是前端标识，用于解决ajax无法回退等问题，所以在后端不用得到)</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// 例如：http://127.0.0.1:3000/a.html?id=123#456</span><br><span class="line"></span><br><span class="line">var http = require(&quot;http&quot;); </span><br><span class="line"></span><br><span class="line">http.createServer(function (req, res) &#123;</span><br><span class="line">    console.log(req.url); </span><br><span class="line">    // http://127.0.0.1:3000/a.html?id=123</span><br><span class="line">    </span><br><span class="line">    res.end(&quot;&quot;);</span><br><span class="line">    </span><br><span class="line">&#125;).listen(3000, &quot;127.0.0.1&quot;); // 直接写监听也可以，还可以限制访问的ip</span><br></pre></td></tr></table></figure>
<p>而此时我们想得到querystring中的某一部分(l例如文件名)，如果用正则提炼就太麻烦了，Node.js中提供了内置模块：url、path、querystring它们都可以服务于URL的识别。</p>
<ul>
<li><strong>url模块</strong>：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">// 例如：http://127.0.0.1:3000/a.html?id=123#456</span><br><span class="line"></span><br><span class="line">var http = require(&quot;http&quot;); </span><br><span class="line">var url = require(&quot;url&quot;);</span><br><span class="line"></span><br><span class="line">http.createServer(function (req, res) &#123;</span><br><span class="line">    // 将URL的字符串转为JSON对象</span><br><span class="line">    var urlJson = url.parse(req.url);</span><br><span class="line">    console.log(urlJson);</span><br><span class="line">    res.end(&quot;&quot;);</span><br><span class="line">    </span><br><span class="line">&#125;).listen(3000, &quot;127.0.0.1&quot;);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>此时url的parse方法会将地址整理为一个对象，但无法正确识别protocol(协议)、host(主机名)、port(端口号)等等。在Linux系统下可以完全识别。<br><img src="img/aiqianduan/WX20200318-174448@2x.png" alt="wx20200312-235536@2x.png"><br>当有多个参数时，用url.parse(req.url, true)形成对象，方便存入数据库：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">// 例如：http://127.0.0.1:3000/a.html?id=123#456</span><br><span class="line"></span><br><span class="line">var http = require(&quot;http&quot;); </span><br><span class="line">var url = require(&quot;url&quot;);</span><br><span class="line"></span><br><span class="line">http.createServer(function (req, res) &#123;</span><br><span class="line">    // 将URL的字符串转为JSON对象</span><br><span class="line">    var urlJson = url.parse(req.url, true); // 增加true</span><br><span class="line">    console.log(urlJson);</span><br><span class="line">    res.end(&quot;&quot;);</span><br><span class="line">    </span><br><span class="line">&#125;).listen(3000, &quot;127.0.0.1&quot;);</span><br></pre></td></tr></table></figure></p>
<p><img src="img/aiqianduan/WX20200318-174502@2x.png" alt="wx20200313-001127@2x.png"></p>
<ul>
<li><p><strong>path模块</strong>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">// 例如：http://127.0.0.1:3000/a.html?id=123#456</span><br><span class="line"></span><br><span class="line">var http = require(&quot;http&quot;); </span><br><span class="line">var url = require(&quot;url&quot;);</span><br><span class="line">var path = require(&quot;path&quot;);</span><br><span class="line"></span><br><span class="line">http.createServer(function (req, res) &#123;</span><br><span class="line">    // 将URL的字符串转为JSON对象</span><br><span class="line">    var urlJson = url.parse(req.url, true); // 增加true</span><br><span class="line">    // 得到文件路径</span><br><span class="line">    var pathName = urlJson.pathname;</span><br><span class="line">    // 得到拓展名</span><br><span class="line">    var extName = path.extname(pathName);</span><br><span class="line">    res.end(&quot;&quot;);</span><br><span class="line">    </span><br><span class="line">&#125;).listen(3000, &quot;127.0.0.1&quot;);</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>querystring模块</strong>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">// 例如：http://127.0.0.1:3000/a.html?id=123#456</span><br><span class="line"></span><br><span class="line">var http = require(&quot;http&quot;); </span><br><span class="line">var url = require(&quot;url&quot;);</span><br><span class="line">var path = require(&quot;path&quot;);</span><br><span class="line">var querystring = require(&quot;querystring&quot;);</span><br><span class="line"></span><br><span class="line">http.createServer(function (req, res) &#123;</span><br><span class="line">    // 将URL的字符串转为JSON对象</span><br><span class="line">    var urlJson = url.parse(req.url);</span><br><span class="line">    // 得到查询字符串</span><br><span class="line">    var qs = urlJson.query;</span><br><span class="line">    // 转为查询对象，和url.parse加上true非常类似</span><br><span class="line">    var qsJson = querystring.parse(qs);</span><br><span class="line">    res.end(&quot;&quot;);</span><br><span class="line">    </span><br><span class="line">&#125;).listen(3000, &quot;127.0.0.1&quot;);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<blockquote>
<p>小项目：静态资源服务器 - 创建一个文件夹myweb，我们的程序能够自动为里面的文件、图片、css、js加上路由</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">var http = require(&quot;http&quot;); </span><br><span class="line">var fs = require(&quot;fs&quot;); </span><br><span class="line">var url = require(&quot;url&quot;);</span><br><span class="line">var path = require(&quot;path&quot;);</span><br><span class="line">var querystring = require(&quot;querystring&quot;);</span><br><span class="line"></span><br><span class="line">http.createServer(function (req, res) &#123;</span><br><span class="line">    // 得到用户想要读取什么文件(输入的网址)</span><br><span class="line">    var pathName = url.parse(req.url).pathname;</span><br><span class="line">    // 真的去读取这个文件(在myweb里找到这个文件并呈现)</span><br><span class="line">    fs.readFile(&quot;./myweb/&quot; + pathName, function(err,data)&#123;</span><br><span class="line">        if(err)&#123;</span><br><span class="line">            res.end(&quot;没有这个文件&quot;);</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line">        res.end(data);</span><br><span class="line">    &#125;);  </span><br><span class="line">&#125;).listen(3000, &quot;127.0.0.1&quot;);</span><br></pre></td></tr></table></figure>
<p>至此，静态资源服务器的框架已经完备，但还有几个点不够完善，比如下行文件中没有文件类型，所以借助<a href="https://www.w3school.com.cn/media/media_mimeref.asp" target="_blank" rel="noopener">++mime类型++</a>修改为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">var http = require(&quot;http&quot;); </span><br><span class="line">var fs = require(&quot;fs&quot;); </span><br><span class="line">var url = require(&quot;url&quot;);</span><br><span class="line">var path = require(&quot;path&quot;);</span><br><span class="line">var querystring = require(&quot;querystring&quot;);</span><br><span class="line"></span><br><span class="line">http.createServer(function (req, res) &#123;</span><br><span class="line">    // 得到用户想要读取什么文件(输入的网址)</span><br><span class="line">    var pathName = url.parse(req.url).pathname;</span><br><span class="line">    // 得到拓展名</span><br><span class="line">    var extName = path.extname(pathName);</span><br><span class="line">    // 准备一个映射关系对</span><br><span class="line">    var mime = &#123;</span><br><span class="line">        &quot;.jpg&quot; : &quot;image/jpeg&quot;,</span><br><span class="line">        &quot;.jpeg&quot; : &quot;image/jpeg&quot;,</span><br><span class="line">        &quot;.gif&quot; : &quot;image/gif&quot;,</span><br><span class="line">        &quot;.png&quot; : &quot;image/png&quot;,</span><br><span class="line">        &quot;.html&quot; : &quot;text/html;chartset=UTF-8&quot;,</span><br><span class="line">        &quot;.css&quot; : &quot;text/css&quot;,</span><br><span class="line">        &quot;.js&quot; : &quot;application/x-javascript&quot;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    // 真的去读取这个文件(在myweb里找到这个文件并呈现)</span><br><span class="line">    fs.readFile(&quot;./myweb/&quot; + pathName, function(err,data)&#123;</span><br><span class="line">        if(err)&#123;</span><br><span class="line">            res.end(&quot;没有这个文件&quot;);</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line">        // 检查是否属于已有的mime类型</span><br><span class="line">        if(mime.hasOwnProperty(extName))&#123;</span><br><span class="line">            res.setHeader(&quot;content-type&quot;, mime[extName]);</span><br><span class="line">        &#125;</span><br><span class="line">        res.end(data);</span><br><span class="line">    &#125;);  </span><br><span class="line">&#125;).listen(3000, &quot;127.0.0.1&quot;);</span><br></pre></td></tr></table></figure></p>
<p>第二个问题：不能自动识别index文件。比如用户输入：<a href="http://127.0.0.1:3000/b" target="_blank" rel="noopener">http://127.0.0.1:3000/b</a> 意思是要读取b文件夹中的index.html！解决思路就是如果用户输入了一个URL不存在拓展名，则自动补全/index.html<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">var http = require(&quot;http&quot;); </span><br><span class="line">var fs = require(&quot;fs&quot;); </span><br><span class="line">var url = require(&quot;url&quot;);</span><br><span class="line">var path = require(&quot;path&quot;);</span><br><span class="line">var querystring = require(&quot;querystring&quot;);</span><br><span class="line"></span><br><span class="line">http.createServer(function (req, res) &#123;</span><br><span class="line">    // 得到用户想要读取什么文件(输入的网址)</span><br><span class="line">    var pathName = url.parse(req.url).pathname;</span><br><span class="line">    // 得到拓展名</span><br><span class="line">    var extName = path.extname(pathName);</span><br><span class="line">    // 如果URL没有拓展名，则表示是文件夹，此时自动补全/index.html</span><br><span class="line">    if(!extName)&#123;</span><br><span class="line">        /* </span><br><span class="line">        此处还有问题！如果网址不是以/结尾，此时会造成浏览器识别文件路径层次有问题！</span><br><span class="line">        比如：</span><br><span class="line">        http://127.0.0.1:3000/a 和</span><br><span class="line">        http://127.0.0.1:3000/a/ 不一样！</span><br><span class="line">        对于同样一张图片，前者认为是同级目录下的图片，后者认为是a文件夹下的图片！所以要再次判断是否结尾是/，不是的话就需要重定向</span><br><span class="line">        */</span><br><span class="line">        if(pathName.substr(-1) != &quot;/&quot;)&#123;</span><br><span class="line">            res.writeHead(302, &#123; &quot;Location&quot; : pathName + &quot;/&quot; &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        pathName += &quot;/index.html&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    // 准备一个映射关系对</span><br><span class="line">    var mime = &#123;</span><br><span class="line">        &quot;.jpg&quot; : &quot;image/jpeg&quot;,</span><br><span class="line">        &quot;.jpeg&quot; : &quot;image/jpeg&quot;,</span><br><span class="line">        &quot;.gif&quot; : &quot;image/gif&quot;,</span><br><span class="line">        &quot;.png&quot; : &quot;image/png&quot;,</span><br><span class="line">        &quot;.html&quot; : &quot;text/html;chartset=UTF-8&quot;,</span><br><span class="line">        &quot;.css&quot; : &quot;text/css&quot;,</span><br><span class="line">        &quot;.js&quot; : &quot;application/x-javascript&quot;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    // 真的去读取这个文件(在myweb里找到这个文件并呈现)</span><br><span class="line">    fs.readFile(&quot;./myweb/&quot; + pathName, function(err,data)&#123;</span><br><span class="line">        if(err)&#123;</span><br><span class="line">            res.end(&quot;没有这个文件&quot;);</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line">        // 检查是否属于已有的mime类型</span><br><span class="line">        if(mime.hasOwnProperty(extName))&#123;</span><br><span class="line">            res.setHeader(&quot;content-type&quot;, mime[extName]);</span><br><span class="line">        &#125;</span><br><span class="line">        res.end(data);</span><br><span class="line">    &#125;);  </span><br><span class="line">&#125;).listen(3000, &quot;127.0.0.1&quot;);</span><br></pre></td></tr></table></figure></p>
<p>还有一个问题，就是304状态码(not modified)。当文件没有改变时，拒绝传输文件！也就是当用户狂点刷新时，其实不发送请求。原理是通过session和cookie保存历史镜像，每次提交时进行比对，如果没有改变则不响应。</p>
<blockquote>
<p>小结：<br>1.Node.js中的fs模块、mongdb模块基本上都是异步方法。一定要记住(当做规矩背)，==异步方法不能通过return返回，不能通过等号来接收数据。必须通过回调函数传实参的模式来传输数据。==<br>2.内置模块用require无条件、无路径的引用，是Node.js天生就有的。</p>
</blockquote>
<ul>
<li><strong>自定义模块</strong>：每一个js文件。==Node.js、webpack、seajs等使用CMD(通用模块定义)规范==；Angular、requirejs等使用的是AMD(异步模块定义)规范。</li>
</ul>
<blockquote>
<p>01.js</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">require(&quot;./test.js&quot;);</span><br><span class="line">console.log(&quot;我是01.js&quot;);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>test.js</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var fs = require(&quot;fs&quot;); </span><br><span class="line">console.log(&quot;我是test.js&quot;);</span><br><span class="line">fs.readFile(&quot;./pig.jpg&quot;, function(err, data)&#123;</span><br><span class="line">    console.log(&quot;图片读取完毕&quot;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>在01.js中引用test.js，会先打出：我是test.js，然后再打出：我是01.js，最后打出：图片读取完毕。说明：</p>
<ul>
<li>require()谁就会运行谁</li>
<li>require(“./test.js”);中的”./“不能省略</li>
<li>require的js文件中如果有异步函数，将不会等待，先执行主文件之后的程序，等异步结束后回调函数会执行。</li>
<li>如果A引用B，此时Node.js发现B又引用了A，则会阻止这次循环引用。</li>
</ul>
<h4 id="6-作用域和暴露"><a href="#6-作用域和暴露" class="headerlink" title="6. 作用域和暴露"></a>6. 作用域和暴露</h4><ul>
<li>exports暴露：当文件有多个东西对外暴露时，使用这个方法</li>
</ul>
<blockquote>
<p>01.js</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">require(&quot;./test.js&quot;);</span><br><span class="line">console.log(&quot;我是01.js，我认识a么？&quot; + a);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>test.js</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var a = 100; </span><br><span class="line">console.log(&quot;我是test的a&quot; + a);</span><br></pre></td></tr></table></figure>
<p>此时将报错，01.js打印出undefined，找不到a，因为==Node.js中每个js都是单独的作用域==(闭包)，和DOM开发不同，浏览器中var一个a此时a会自动成为window对象的属性，此时js文件和js文件可以共享作用域；但是Node.js中每个js文件天生是隔离作用域的，所以想要访问其内部的变量或方法，必须先通过exports.xx = xx暴露出去</p>
<blockquote>
<p>01.js</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var test = require(&quot;./test.js&quot;);</span><br><span class="line">console.log(&quot;我是01.js，我认识a么？&quot; + test.a);</span><br><span class="line">console.log(&quot;我是01.js，我认识b么？&quot; + test.b);</span><br><span class="line"></span><br><span class="line">var result = test.zonghe();</span><br><span class="line">console.log(&quot;总和是&quot; + result);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>test.js</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">var a = 100; </span><br><span class="line">var b = 200; </span><br><span class="line"></span><br><span class="line">exports.a = a;</span><br><span class="line">exports.b = b;</span><br><span class="line"></span><br><span class="line">function zonghe()&#123;</span><br><span class="line">    return a + b + c;</span><br><span class="line">&#125;</span><br><span class="line">exports.zonghe = zonghe;</span><br></pre></td></tr></table></figure>
<ul>
<li>module.exports暴露：当文件只有一个东西对外暴露时，用这个方法</li>
</ul>
<blockquote>
<p>01.js</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var People = require(&quot;./People.js&quot;);</span><br><span class="line"></span><br><span class="line">// var xiaoming = new People.People(&quot;小明&quot;,&quot;男&quot;,12);</span><br><span class="line">var xiaoming = new People(&quot;小明&quot;,&quot;男&quot;,12);</span><br><span class="line">xiaoming.sayHello();</span><br></pre></td></tr></table></figure>
<blockquote>
<p>People.js</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">function People(name, sex, age)&#123;</span><br><span class="line">    this.name = name;</span><br><span class="line">    this.sex = sex;</span><br><span class="line">    this.age = age;</span><br><span class="line">&#125;</span><br><span class="line">People.prototype.sayHello = function()&#123;</span><br><span class="line">    console.log(&quot;你好，我叫&quot; + this.name + &quot;我今年&quot; + this.age + &quot;我是&quot; + this.sex + &quot;的&quot;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// exports.People = People; </span><br><span class="line">// 如果这里用这种形式暴露的话，那么01.js中用来接收的People会直接替换exports，所以在使用时才会出现People.People这种很怪的方式</span><br><span class="line"></span><br><span class="line">module.exports = People;</span><br><span class="line">// 使用module.exports时等号右边的东西，将自动传给01.js中用来接收的var People</span><br></pre></td></tr></table></figure>
<h4 id="7-神奇的node-modules文件夹"><a href="#7-神奇的node-modules文件夹" class="headerlink" title="7. 神奇的node_modules文件夹"></a>7. 神奇的node_modules文件夹</h4><p>如果我们写了一个引用没有”./“，则说明引用的是node_modules文件夹里的东西<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var People = require(&quot;People.js&quot;);</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>node_modules文件夹只要存在于要引用它的js文件的祖先路径中，就可以直接引用，无视路径层级</p>
</blockquote>
<h4 id="8-npm的世界"><a href="#8-npm的世界" class="headerlink" title="8. npm的世界"></a>8. npm的世界</h4><p>Node.js的开发者们希望全世界的程序猿都可以贡献自己的代码，避免重复造轮子，所以主导了一个社区，叫做npm(node package management, node包管理器)  </p>
<ul>
<li>npm的使用<br>官网：<a href="https://www.npmjs.com" target="_blank" rel="noopener">https://www.npmjs.com</a><br>淘宝镜像：<a href="http://npm.taobao.org" target="_blank" rel="noopener">http://npm.taobao.org</a><br>我们可以到npm上面直接寻找我们想要的模块，然后直接npm install就可以了</li>
<li>使用package.json来管理依赖<br>npm有一个创造性的举动，可以让开发者声明自己的项目的全部依赖。在项目目录下创建一个叫做package.json的文件来记录。初次创建项目时，可以在项目文件夹下，通过<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm init</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>命令来初始化一个package.json文件，而使用–save命令，在安装依赖的同时，会把依赖写进package.json文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install xxx --save</span><br></pre></td></tr></table></figure></p>
<p>安装时也可以强制安装某个版本<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install xxx#^1.0.0 --save</span><br></pre></td></tr></table></figure></p>
<p>关于版本号的常用符号：<br>|符号|对应的版本号含义|<br>|:–|:–|<br>|确数(1.0.2)|确定的某个版本|<br>|&gt;、&gt;=、&lt;、&lt;=|高于/低于…某个版本|<br>|~|大约近似等于某个版本，如果有就一定用这个版本，没有就用最近的|<br>|^|寻找和某个版本兼容的版本，如果有就一定用这个版本，没有就用最近的|<br>|*|匹配任何版本|<br>|laste|寻找最新版本|</p>
<ul>
<li>全局安装淘宝镜像<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install xxx -g // 全局安装某个包</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>一些CLI(命令行程序)、工程化的东西安装在全局<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g cnpm --registry=https://registry.npm.taobao.org</span><br></pre></td></tr></table></figure></p>
<h4 id="9-GET和POST请求"><a href="#9-GET和POST请求" class="headerlink" title="9. GET和POST请求"></a>9. GET和POST请求</h4><blockquote>
<p>先安装一个小型服务器</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cnpm install serve-static --save</span><br><span class="line">cnpm install finalhandler --save</span><br></pre></td></tr></table></figure>
<p>然后去<a href="npm.taobao.org">淘宝镜像</a>上根据包名查找对应的API，抄一些用法过来，详见nootbook/get&amp;post</p>
<ul>
<li>GET请求：</li>
</ul>
<blockquote>
<p>01.js</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">var finalhandler = require(&apos;finalhandler&apos;)</span><br><span class="line">var http = require(&apos;http&apos;)</span><br><span class="line">var serveStatic = require(&apos;serve-static&apos;)</span><br><span class="line">var url = require(&quot;url&quot;)</span><br><span class="line">var fs = require(&quot;fs&quot;)</span><br><span class="line"></span><br><span class="line">// 配置静态资源服务器</span><br><span class="line">var serve = serveStatic(&apos;public&apos;, &#123; &apos;index&apos;: [&apos;index.html&apos;, &apos;index.htm&apos;] &#125;)</span><br><span class="line"></span><br><span class="line">// Create server</span><br><span class="line">var server = http.createServer(function onRequest(req, res) &#123;</span><br><span class="line">    // 路由</span><br><span class="line">    var pathName = url.parse(req.url).pathname;</span><br><span class="line">    if (pathName == &quot;/addStudent&quot;) &#123;</span><br><span class="line">        // 拿到GET请求参数，也就是那到地址栏中的东西</span><br><span class="line">        var queryJSON = url.parse(req.url, true).query;</span><br><span class="line">        // 整理数据</span><br><span class="line">        var data = &quot;姓名&quot; + queryJSON.name + &quot;\n&quot;;</span><br><span class="line">        data += &quot;年龄&quot; + queryJSON.age + &quot;\n&quot;;</span><br><span class="line">        data += &quot;性别&quot; + queryJSON.sex + &quot;\n&quot;;</span><br><span class="line">        // 写入文件</span><br><span class="line">        fs.writeFile(&quot;./student_data/&quot; + queryJSON.name + &quot;.txt&quot;, data, function(err, data) &#123;</span><br><span class="line">            if (err) &#123;</span><br><span class="line">                res.end(&quot;cuowu&quot;);</span><br><span class="line">                return;</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                res.end(&quot;chenggong&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        </span><br><span class="line">        return; </span><br><span class="line">        // 注意必须要加return，不然会报404错误！是由于不返回的话会再次匹配静态资源造成的</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 使用静态资源，将public文件夹下的内容静态化出来。这个要放在下面。</span><br><span class="line">    serve(req, res, finalhandler(req, res));</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">// Listen</span><br><span class="line">server.listen(3000)</span><br><span class="line">console.log(&quot;服务器已经运行在3000端口&quot;);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>public/index.html</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span><br><span class="line">    &lt;title&gt;Document&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;p&gt;姓名：&lt;input type=&quot;text&quot; name=&quot;name&quot; /&gt;&lt;/p&gt;</span><br><span class="line">    &lt;p&gt;年龄：&lt;input type=&quot;text&quot; name=&quot;age&quot; /&gt;&lt;/p&gt;</span><br><span class="line">    &lt;p&gt;性别：</span><br><span class="line">        &lt;label&gt;&lt;input type=&quot;radio&quot; name=&quot;sex&quot; value=&quot;男&quot; /&gt;男&lt;/label&gt;</span><br><span class="line">        &lt;label&gt;&lt;input type=&quot;radio&quot; name=&quot;sex&quot; value=&quot;女&quot; /&gt;女&lt;/label&gt;</span><br><span class="line">    &lt;/p&gt;</span><br><span class="line">    &lt;p&gt;&lt;input type=&quot;button&quot; value=&quot;按我发出GET请求&quot; id=&quot;btn1&quot; /&gt;&lt;/p&gt;</span><br><span class="line">    &lt;p&gt;&lt;input type=&quot;button&quot; value=&quot;按我发出POST请求&quot; id=&quot;btn2&quot; /&gt;&lt;/p&gt;</span><br><span class="line">    &lt;script type=&quot;text/javascript&quot; src=&quot;jquery.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">        $(&quot;#btn1&quot;).click(function() &#123;</span><br><span class="line">            // 读取表单</span><br><span class="line">            var name = $(&quot;input[name=name]&quot;).val();</span><br><span class="line">            var age = $(&quot;input[name=age]&quot;).val();</span><br><span class="line">            var sex = $(&quot;input[name=sex]&quot;).val();</span><br><span class="line"></span><br><span class="line">            // 发送请求</span><br><span class="line">            $.get(&quot;/addStudent&quot;, &#123;</span><br><span class="line">                name : name,</span><br><span class="line">                age : age,</span><br><span class="line">                sex : sex</span><br><span class="line">            &#125;, function(data) &#123;</span><br><span class="line">                if (data == &quot;chenggong&quot;) &#123;</span><br><span class="line">                    alert(&quot;恭喜，学生已成功添加！&quot;)</span><br><span class="line">                &#125;else &#123;</span><br><span class="line">                    alert(&quot;对不起，服务器错误！&quot;)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">        $(&quot;#btn2&quot;).click(function () &#123;</span><br><span class="line">                // 读取表单</span><br><span class="line">                var name = $(&quot;input[name=name]&quot;).val();</span><br><span class="line">                var age = $(&quot;input[name=age]&quot;).val();</span><br><span class="line">                var sex = $(&quot;input[name=sex]&quot;).val();</span><br><span class="line"></span><br><span class="line">                // 发送请求</span><br><span class="line">                $.post(&quot;/addStudent&quot;, &#123;</span><br><span class="line">                    name: name,</span><br><span class="line">                    age: age,</span><br><span class="line">                    sex: sex</span><br><span class="line">                &#125;, function (data) &#123;</span><br><span class="line">                    if (data == &quot;chenggong&quot;) &#123;</span><br><span class="line">                        alert(&quot;恭喜，学生已成功添加！&quot;)</span><br><span class="line">                    &#125; else &#123;</span><br><span class="line">                        alert(&quot;对不起，服务器错误！&quot;)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;)</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>POST请求</li>
</ul>
<blockquote>
<p>02.js</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line">    演示POST请求的获得</span><br><span class="line">*/</span><br><span class="line">var finalhandler = require(&apos;finalhandler&apos;)</span><br><span class="line">var http = require(&apos;http&apos;)</span><br><span class="line">var serveStatic = require(&apos;serve-static&apos;)</span><br><span class="line">var url = require(&quot;url&quot;)</span><br><span class="line">var fs = require(&quot;fs&quot;)</span><br><span class="line">var querystring = require(&quot;querystring&quot;)</span><br><span class="line"></span><br><span class="line">// 配置静态资源服务器</span><br><span class="line">var serve = serveStatic(&apos;public&apos;, &#123; &apos;index&apos;: [&apos;index.html&apos;, &apos;index.htm&apos;] &#125;)</span><br><span class="line"></span><br><span class="line">// Create server</span><br><span class="line">var server = http.createServer(function onRequest(req, res) &#123;</span><br><span class="line">    // 路由</span><br><span class="line">    var pathName = url.parse(req.url).pathname;</span><br><span class="line">    if (pathName == &quot;/addStudent&quot;) &#123;</span><br><span class="line">        // 定义了一个post变量，用于暂存请求体的信息</span><br><span class="line">        var content = &apos;&apos;;</span><br><span class="line"></span><br><span class="line">        // post请求经常会很长，此时会分段传送，大约每段800k左右一个HTTP报文段</span><br><span class="line">        // 通过req的data事件监听函数，每当接受到请求体的数据，就累加到post变量中</span><br><span class="line">        req.on(&apos;data&apos;, function (chunk) &#123;</span><br><span class="line">            // 将段落合并</span><br><span class="line">            content += chunk;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        // 当所有数据发送完毕后，会触发end事件，通过querystring.parse将post解析为真正的POST请求格式，然后向客户端返回。</span><br><span class="line">        req.on(&apos;end&apos;, function () &#123;</span><br><span class="line">            content = querystring.parse(content);</span><br><span class="line"></span><br><span class="line">            // 整理数据</span><br><span class="line">            var data = &quot;姓名&quot; + content.name + &quot;\n&quot;;</span><br><span class="line">            data += &quot;年龄&quot; + content.age + &quot;\n&quot;;</span><br><span class="line">            data += &quot;性别&quot; + content.sex + &quot;\n&quot;;</span><br><span class="line">            // 写入文件</span><br><span class="line">            fs.writeFile(&quot;./student_data/&quot; + content.name + &quot;.txt&quot;, data, function (err, data) &#123;</span><br><span class="line">                if (err) &#123;</span><br><span class="line">                    res.end(&quot;cuowu&quot;);</span><br><span class="line">                    return;</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    res.end(&quot;chenggong&quot;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line"></span><br><span class="line">            res.end(&quot;chengogng&quot;);</span><br><span class="line">        &#125;);</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">        return;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 使用静态资源。这个要放在下面。</span><br><span class="line">    serve(req, res, finalhandler(req, res));</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">// Listen</span><br><span class="line">server.listen(3000)</span><br><span class="line">console.log(&quot;服务器已经运行在3000端口&quot;);</span><br></pre></td></tr></table></figure>
<h4 id="10-formidable模块：npm上可以下载一个formidable的模块，用来处理post请求。甚至可以处理图片、zip文件等的上传。"><a href="#10-formidable模块：npm上可以下载一个formidable的模块，用来处理post请求。甚至可以处理图片、zip文件等的上传。" class="headerlink" title="10. formidable模块：npm上可以下载一个formidable的模块，用来处理post请求。甚至可以处理图片、zip文件等的上传。"></a>10. formidable模块：npm上可以下载一个formidable的模块，用来处理post请求。甚至可以处理图片、zip文件等的上传。</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install formidable --save // 安装依赖</span><br></pre></td></tr></table></figure>
<p>具体代码详见03.js和upload.html<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line">    演示POST请求通过formidable模块来处理参数</span><br><span class="line">*/</span><br><span class="line">var finalhandler = require(&apos;finalhandler&apos;)</span><br><span class="line">var http = require(&apos;http&apos;)</span><br><span class="line">var serveStatic = require(&apos;serve-static&apos;)</span><br><span class="line">var url = require(&quot;url&quot;)</span><br><span class="line">var fs = require(&quot;fs&quot;)</span><br><span class="line">var querystring = require(&quot;querystring&quot;)</span><br><span class="line">const formidable = require(&apos;formidable&apos;)</span><br><span class="line">const path = require(&apos;path&apos;)</span><br><span class="line"></span><br><span class="line">// 配置静态资源服务器</span><br><span class="line">var serve = serveStatic(&apos;public&apos;, &#123;</span><br><span class="line">    &apos;index&apos;: [&apos;index.html&apos;, &apos;index.htm&apos;]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">// Create server</span><br><span class="line">var server = http.createServer(function onRequest(req, res) &#123;</span><br><span class="line">    // 路由</span><br><span class="line">    var pathName = url.parse(req.url).pathname;</span><br><span class="line">    </span><br><span class="line">    if (pathName == &quot;/shangchuan&quot;) &#123;</span><br><span class="line">        // 照抄npm.taobao.org上的API</span><br><span class="line">        const form = formidable(&#123;</span><br><span class="line">            multiples: true</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        // 设置上传的文件存放在哪里</span><br><span class="line">        form.uploadDir = &quot;./uploads&quot;</span><br><span class="line"></span><br><span class="line">        form.parse(req, (err, fields, files) =&gt; &#123;</span><br><span class="line">            // fields 表示普通控件</span><br><span class="line">            // files  表示文件控件</span><br><span class="line"></span><br><span class="line">            // 检测是否有文件</span><br><span class="line">            if (!files.touxiang) &#123;</span><br><span class="line">                return</span><br><span class="line">            &#125;</span><br><span class="line">            // 检测是否有上传文件</span><br><span class="line">            if (!files.touxiang.name) &#123;</span><br><span class="line">                res.end(&quot;请选择文件&quot;)</span><br><span class="line">                return</span><br><span class="line">            &#125;</span><br><span class="line">            // 得到拓展名</span><br><span class="line">            var extname = path.extname(files.touxiang.name);</span><br><span class="line">            // 为上传的文件加上拓展名</span><br><span class="line">            fs.rename(files.touxiang.path, files.touxiang.path + extname, function() &#123;</span><br><span class="line">                res.end(&quot;上传成功&quot;)</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        return;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 使用静态资源。这个要放在下面。</span><br><span class="line">    serve(req, res, finalhandler(req, res));</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">// Listen</span><br><span class="line">server.listen(3000)</span><br><span class="line">console.log(&quot;服务器已经运行在3000端口&quot;);</span><br></pre></td></tr></table></figure></p>
<p>待补充(两个大包)</p>
<h4 id="11-Express-js框架："><a href="#11-Express-js框架：" class="headerlink" title="11. Express.js框架："></a>11. Express.js框架：</h4><blockquote>
<p>解决了哪些问题</p>
<ul>
<li>路由不方便制作，尤其是正则表达式路由</li>
<li>静态资源服务不方便</li>
<li>页面呈递不方便，没有模板引擎</li>
</ul>
</blockquote>
<blockquote>
<p>官网：<a href="www.expressjs.com.cn">www.expressjs.com.cn</a></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cnpm install express --save</span><br></pre></td></tr></table></figure>
<p>基本使用方法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">var express = require(&quot;express&quot;);</span><br><span class="line">var app = express();</span><br><span class="line">// 中间件(注意顺序)</span><br><span class="line">app.get(&quot;/&quot;, function()&#123;</span><br><span class="line">    res.send(&quot;我是首页&quot;);</span><br><span class="line">&#125;)</span><br><span class="line">app.get(&quot;/music&quot;, function()&#123;</span><br><span class="line">    res.send(&quot;音乐频道&quot;);</span><br><span class="line">&#125;)</span><br><span class="line">app.get(&quot;/news&quot;, function()&#123;</span><br><span class="line">    res.send(&quot;新闻频道&quot;);</span><br><span class="line">&#125;)</span><br><span class="line">app.get(&quot;/student/:xuehao&quot;, function()&#123;</span><br><span class="line">    if(/^[\d]&#123;6&#125;$/.test(req.params.xuehao))&#123;</span><br><span class="line">        res.send(&quot;学生频道，学号&quot; + req.params.xuehao);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        res.send(&quot;学号有误，应该是6位数字&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">app.get(&quot;/student/:123&quot;, function()&#123;</span><br><span class="line">    res.send(&quot;123是班长&quot; + req.params.xuehao);</span><br><span class="line">    // 这个中间件将不会被匹配到，因为上面匹配到了学号就不会再往下走了</span><br><span class="line">&#125;)</span><br><span class="line">// 静态化public文件夹，无论get还是post都能使用</span><br><span class="line">app.use(express.static(&quot;./public&quot;));</span><br><span class="line">// 将public文件夹中的东西映射到jingtai文件夹中(访问路径也变为/jingtai/xxx)</span><br><span class="line">app.use(&quot;./jingtai&quot;, express.static(&quot;./public&quot;));</span><br><span class="line"></span><br><span class="line">app.listen(3000);</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>中间件特点：</p>
<ul>
<li>输出使用res.send()而不是res.end()</li>
<li>自动使用pathname与/news进行比较，也就是说会自动过滤掉querystring、hash等等</li>
<li>可以用：来引导一个变量，此时特别方便做一个正则的路由，并用req.params.xxx获取</li>
</ul>
</blockquote>
<blockquote>
<p>需求：当访问 / 时，其实真正想访问的页面是public/haha.html</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">app.get(&quot;/&quot;, function()&#123;</span><br><span class="line">    res.sendFile(__dirname + &quot;/public/haha.html&quot;);</span><br><span class="line">&#125;)</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>==res常用的函数是send和sendFile。sendFile表示发送一个页面给用户。注意sendFile必须使用绝对路径当做参数，而__dirname表示当前这个js文件的绝对路径==</p>
<h4 id="12-模板引擎：express可以象PHP一样使用后台语言模板，此时最好用的模板引擎叫做ejs模板引擎。"><a href="#12-模板引擎：express可以象PHP一样使用后台语言模板，此时最好用的模板引擎叫做ejs模板引擎。" class="headerlink" title="12. 模板引擎：express可以象PHP一样使用后台语言模板，此时最好用的模板引擎叫做ejs模板引擎。"></a>12. 模板引擎：express可以象PHP一样使用后台语言模板，此时最好用的模板引擎叫做ejs模板引擎。</h4><p>API：<a href="https://npm.taobao.org/package/ejs" target="_blank" rel="noopener">https://npm.taobao.org/package/ejs</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cnpm install ejs --save</span><br></pre></td></tr></table></figure></p>
<p>基本使用方法：</p>
<blockquote>
<p>01.js</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">var express = require(&quot;express&quot;);</span><br><span class="line">var app = express();</span><br><span class="line"></span><br><span class="line">// 设置默认的模板引擎，此时express将帮你引入ejs，所以一定要提前装好依赖</span><br><span class="line">app.set(&quot;view engine&quot;, &quot;ejs&quot;);</span><br><span class="line"></span><br><span class="line">app.get(&quot;/&quot;, function()&#123;</span><br><span class="line">    res.render(&quot;shouye&quot;,&#123;</span><br><span class="line">        &quot;dongxi&quot; : &quot;八个手机&quot;,</span><br><span class="line">        &quot;qian&quot; : 1000 * 8</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.listen(3000);</span><br></pre></td></tr></table></figure>
<p>此时当用户访问 / 的时候，会自动使用views文件夹里的shouye.ejs文件当做模板。字典就是后面传入的json。</p>
<blockquote>
<p>views/shouye.ejs</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span><br><span class="line">    &lt;title&gt;Document&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;h1&gt;我买了&lt;% dongxi %&gt;，花了&lt;% qian %&gt;元&lt;/h1&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>注意：ejs就是html，写法完全一样！</p>
<h4 id="13-MVC设计模式："><a href="#13-MVC设计模式：" class="headerlink" title="13. MVC设计模式："></a>13. MVC设计模式：</h4><p>MVC是一种使用Model(模型)、View(视图)、Controller(控制器)设计创建Web应用程序的模式。</p>
<ul>
<li>Model(模型)是应用程序中处理应用程序数据逻辑的部分，通常模型对象负责在数据库中存取数据。</li>
<li>View(视图)是应用程序中处理数据显示的部分，通常视图是依据模型数据创建的。</li>
<li>Controller(控制器)是应用程序中处理用户交互的部分，通常控制器负责从视图读取数据，控制用户输入，并向模型发送数据。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">graph TB</span><br><span class="line">A(Controller) --&gt;B(Model)</span><br><span class="line">B(Model) --&gt;A(Controller)</span><br><span class="line">A(Controller) --&gt;C(View)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>因数计算器和点餐系统代码详见作业</p>
<h4 id="14-MongoDB芒果数据库"><a href="#14-MongoDB芒果数据库" class="headerlink" title="14. MongoDB芒果数据库"></a>14. MongoDB芒果数据库</h4><blockquote>
<p>NoSQL简介</p>
</blockquote>
<ul>
<li>SQL就是Structor Query Language(结构化语言)。MySQL、Oracle、SQL Server数据库都是SQL数据库，在大数据时代有些场景使用它们显得太笨重，因为SQL有一个非常大的缺点，就是限制字段：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">比如现在数据库中已经有10万条数据了(在今天10万条都不算大数据)，如果想从下一条数据开始增加字段，此时之前的10万条数据都需要被更改！表的字段是不能自由更改的，不能某一个条目有一些字段，另外的条目没有！</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>而SQL的优势在于能够轻松执行复杂查找，例如主从关系查找等。但在大数据时代SQL的优势在衰减(基本都是简单查询)，而缺点在被放大。所以此时NoSQL(Not Only SQL)这种==非关系型数据库==应运而生。</p>
<p>NoSQL中没有字段的概念，每个条目可以自由设置字段。</p>
<blockquote>
<p>MongoDB安装与配置详见踩坑之各种报错篇，创建好数据库后就可以进行各种指令操作数据库了。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&gt; use student</span><br><span class="line">// 创建名为student的数据库，此时可以用db来代表这个数据库</span><br><span class="line"></span><br><span class="line">db.banji01.insert(&#123;&quot;name&quot;:&quot;小明&quot;,&quot;age&quot;:12&#125;)</span><br><span class="line">// 在student数据库(此处用db代表)中创建banji01集合(表)，并插入一条数据(数据用json格式)</span><br><span class="line"></span><br><span class="line">db.banji01.find();</span><br><span class="line">// 查找banji01表中的数据(会为你填上随机数的id)</span><br><span class="line"></span><br><span class="line">db.banji01.insert(&#123;&quot;name&quot;:&quot;小红&quot;,&quot;age&quot;:12&#125;)</span><br><span class="line">db.banji01.insert(&#123;&quot;name&quot;:&quot;小强&quot;,&quot;age&quot;:11&#125;)</span><br><span class="line"></span><br><span class="line">db.banji01.find(&#123;&quot;age&quot;:12&#125;);</span><br><span class="line">// 有条件查找</span><br></pre></td></tr></table></figure>
<h4 id="15-Node-js和MongoDB的连接"><a href="#15-Node-js和MongoDB的连接" class="headerlink" title="15. Node.js和MongoDB的连接"></a>15. Node.js和MongoDB的连接</h4><p><a href="https://docs.mongodb.com/ecosystem/drivers/node/" target="_blank" rel="noopener">API</a></p>
<ul>
<li>先安装依赖<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cnpm install mongodb --save</span><br></pre></td></tr></table></figure>
</li>
</ul>
<blockquote>
<p>文档与集合的关系：</p>
<ul>
<li>文档<br><img src="img/aiqianduan/WX20200318-174539@2x.png" alt="1584430515111.jpg"></li>
<li>集合<br><img src="img/aiqianduan/WX20200318-174550@2x.png" alt="wx20200317-153442@2x.png"></li>
</ul>
</blockquote>
<p>在REPL环境中最常用的命令语句，除了上面用到的，还有：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; use student // 使用student数据库，没有就创建</span><br><span class="line">&gt; show dbs // 显示所有数据库列表</span><br><span class="line">&gt; show collections // 显示当前数据库的所有集合列表</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>增删改查：<a href="http://mongodb.github.io/node-mongodb-native/3.5/tutorials/crud/" target="_blank" rel="noopener">API</a></p>
</blockquote>
<ul>
<li><p>增(mongodb/01.js)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">const MongoClient = require(&apos;mongodb&apos;).MongoClient;</span><br><span class="line">// const assert = require(&apos;assert&apos;); // 断言</span><br><span class="line"></span><br><span class="line">// 连接的url</span><br><span class="line">const url = &apos;mongodb://localhost:27017&apos;;</span><br><span class="line"></span><br><span class="line">// 数据库名</span><br><span class="line">const dbName = &apos;student&apos;;</span><br><span class="line"></span><br><span class="line">// 建立一个新连接</span><br><span class="line">const client = new MongoClient(url);</span><br><span class="line"></span><br><span class="line">// 用connect方法连接服务</span><br><span class="line">client.connect(function (err, client) &#123;</span><br><span class="line">    // assert.equal(null, err); // 断言验证</span><br><span class="line">    if (err) &#123;</span><br><span class="line">        console.log(&quot;数据库连接失败！&quot;)</span><br><span class="line">        return</span><br><span class="line">    &#125;</span><br><span class="line">    console.log(&quot;数据库连接成功&quot;);</span><br><span class="line"></span><br><span class="line">    // 用db代替数据库名</span><br><span class="line">    const db = client.db(dbName);</span><br><span class="line"></span><br><span class="line">    // 在指定的表内插入一条数据</span><br><span class="line">    db.collection(&apos;banji01&apos;).insertOne(&#123;</span><br><span class="line">        &quot;name&quot;: &quot;刘备&quot;,</span><br><span class="line">        &quot;age&quot; : 12</span><br><span class="line">    &#125;, function (err, r) &#123;</span><br><span class="line">        // assert.equal(null, err); // 断言验证</span><br><span class="line">        // assert.equal(1, r.insertedCount); // 断言验证</span><br><span class="line">        if (err) &#123;</span><br><span class="line">            console.log(&quot;数据插入失败！&quot;)</span><br><span class="line">            return</span><br><span class="line">        &#125;</span><br><span class="line">        console.log(&quot;成功插入了&quot; + r.insertedCount + &quot;条数据&quot;)</span><br><span class="line"></span><br><span class="line">        // 插入多条数据的方法</span><br><span class="line">        db.collection(&apos;banji01&apos;).insertMany([&#123; a: 2 &#125;, &#123; a: 3 &#125;], function (err, r) &#123;</span><br><span class="line">            assert.equal(null, err);</span><br><span class="line">            assert.equal(2, r.insertedCount);</span><br><span class="line">            // 关闭数据库</span><br><span class="line">            client.close();</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>删</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">const MongoClient = require(&apos;mongodb&apos;).MongoClient;</span><br><span class="line"></span><br><span class="line">const url = &apos;mongodb://localhost:27017&apos;;</span><br><span class="line"></span><br><span class="line">const dbName = &apos;myproject&apos;;</span><br><span class="line"></span><br><span class="line">const client = new MongoClient(url);</span><br><span class="line"></span><br><span class="line">client.connect(function(err, client) &#123;</span><br><span class="line">  assert.equal(null, err);</span><br><span class="line">  console.log(&quot;Connected correctly to server&quot;);</span><br><span class="line"></span><br><span class="line">  const db = client.db(dbName);</span><br><span class="line"></span><br><span class="line">  const col = db.collection(&apos;removes&apos;);</span><br><span class="line">  // Insert multiple documents</span><br><span class="line">  col.insertMany([&#123;a:1&#125;, &#123;a:2&#125;, &#123;a:2&#125;], function(err, r) &#123;</span><br><span class="line">    assert.equal(null, err);</span><br><span class="line">    assert.equal(3, r.insertedCount);</span><br><span class="line"></span><br><span class="line">    // Remove a single document</span><br><span class="line">    col.deleteOne(&#123;a:1&#125;, function(err, r) &#123;</span><br><span class="line">      assert.equal(null, err);</span><br><span class="line">      assert.equal(1, r.deletedCount);</span><br><span class="line"></span><br><span class="line">      // Update multiple documents</span><br><span class="line">      col.deleteMany(&#123;a:2&#125;, function(err, r) &#123;</span><br><span class="line">        assert.equal(null, err);</span><br><span class="line">        assert.equal(2, r.deletedCount);</span><br><span class="line">        client.close();</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>查 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">db.collection(&apos;banji01&apos;).find(&#123;&quot;name&quot;:&quot;小明&quot;&#125;).toArray(</span><br><span class="line">// 注意与其他的不同，这里find的结果要先转成数组</span><br><span class="line">    function(err,results)&#123;</span><br><span class="line">        if (err) &#123;</span><br><span class="line">            console.log(&quot;数据查询失败！&quot;)</span><br><span class="line">            return</span><br><span class="line">        &#125;</span><br><span class="line">        console.log(results) // 打印出查询到的条目</span><br><span class="line">        db.close()</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>多个查询条件时，例如寻找姓名是小明且年龄为12的学生，用“ ，”隔开。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">db.collection(&apos;banji01&apos;).find(&#123;</span><br><span class="line">    &quot;name&quot;:&quot;小明&quot;,</span><br><span class="line">    &quot;age&quot;:12</span><br><span class="line">&#125;).toArray(</span><br><span class="line">    function(err,results)&#123;</span><br><span class="line">        if (err) &#123;</span><br><span class="line">            console.log(&quot;数据查询失败！&quot;)</span><br><span class="line">            return</span><br><span class="line">        &#125;</span><br><span class="line">        console.log(results) // 打印出查询到的条目</span><br><span class="line">        db.close()</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<p>查询条件中的大于、小于条件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">db.collection(&apos;banji01&apos;).find(&#123;</span><br><span class="line">    &quot;age&quot;:&#123;$gt : 12&#125; // &#123;$gt : 12&#125;表示大于12</span><br><span class="line">    //&quot;age&quot;:&#123;$lt : 12&#125; // &#123;$lt : 12&#125;表示大于12</span><br><span class="line">&#125;).toArray(</span><br><span class="line">    function(err,results)&#123;</span><br><span class="line">        if (err) &#123;</span><br><span class="line">            console.log(&quot;数据查询失败！&quot;)</span><br><span class="line">            return</span><br><span class="line">        &#125;</span><br><span class="line">        console.log(results) // 打印出查询到的条目</span><br><span class="line">        db.close()</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<p>或逻辑：用$or来引导一个数组，里面是或的条件。例如寻找年龄大于12岁的男生或者年龄小于11岁的女生<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">db.collection(&apos;banji01&apos;).find(&#123;</span><br><span class="line">    &#123;$or : [</span><br><span class="line">        &#123; &quot;age&quot;:&#123;$gt:12&#125; , &quot;sex&quot;: &quot;男&quot;&#125;,</span><br><span class="line">        &#123; &quot;age&quot;:&#123;$lt:11&#125; , &quot;sex&quot;: &quot;女&quot;&#125;</span><br><span class="line">    ]&#125;</span><br><span class="line">&#125;).toArray(</span><br><span class="line">    function(err,results)&#123;</span><br><span class="line">        if (err) &#123;</span><br><span class="line">            console.log(&quot;数据查询失败！&quot;)</span><br><span class="line">            return</span><br><span class="line">        &#125;</span><br><span class="line">        console.log(results) // 打印出查询到的条目</span><br><span class="line">        db.close()</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<ul>
<li>改：分为增量改和彻底改两种。彻底改用处不大，就是把一条数据完全改成另一条数据，此举危险！<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">db.collection(&apos;banji01&apos;).updateOne(</span><br><span class="line">    &#123;&quot;name&quot;: &quot;刘备&quot;&#125;,</span><br><span class="line">    &#123;&quot;age&quot; : 12&#125;</span><br><span class="line">, function (err, r) &#123;</span><br><span class="line">    if (err) &#123;</span><br><span class="line">        console.log(&quot;数据修改失败！&quot;)</span><br><span class="line">        return</span><br><span class="line">    &#125;</span><br><span class="line">    console.log(&quot;成功&quot;)</span><br><span class="line">    // 此时&quot;name&quot;: &quot;刘备&quot;会被替换成&quot;age&quot; : 12</span><br><span class="line">    // &quot;name&quot;: &quot;刘备&quot;这个属性就没了！</span><br><span class="line">    client.close();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>增量改：用$set引导<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">db.collection(&apos;banji01&apos;).updateOne(</span><br><span class="line">    &#123;&quot;name&quot;: &quot;刘备&quot;&#125;,</span><br><span class="line">    &#123;$set:&#123;&quot;age&quot; : 12&#125;&#125;</span><br><span class="line">, function (err, r) &#123;</span><br><span class="line">    if (err) &#123;</span><br><span class="line">        console.log(&quot;数据修改失败！&quot;)</span><br><span class="line">        return</span><br><span class="line">    &#125;</span><br><span class="line">    console.log(&quot;成功&quot;)</span><br><span class="line">    // 此时刘备的age会被替换成12！</span><br><span class="line">    client.close();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<h4 id="16-MongoDB"><a href="#16-MongoDB" class="headerlink" title="16. MongoDB"></a>16. MongoDB</h4><p>数据库 = 存储东西 + 数据库操作API。</p>
<h2 id="React"><a href="#React" class="headerlink" title="React"></a>React</h2><h2 id="Vue"><a href="#Vue" class="headerlink" title="Vue"></a>Vue</h2><h3 id="一、简介"><a href="#一、简介" class="headerlink" title="一、简介"></a>一、简介</h3><p>vue提供了一种“引包法”，初学者在这个模式下学习基本语法，不需要webpack，不需要CMD打包</p>
<h3 id="二、启动"><a href="#二、启动" class="headerlink" title="二、启动"></a>二、启动</h3><blockquote>
<p>vue的包：<a href="https://cn.vuejs.org/js/vue.js" target="_blank" rel="noopener">https://cn.vuejs.org/js/vue.js</a>，使用方式如下：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">        &lt;h1&gt;&#123;&#123;1 + 1&#125;&#125;&lt;/h1&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;script type=&quot;text/javascript&quot; src=&quot;./jslib/vue.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        new Vue(&#123;</span><br><span class="line">            el : &quot;#app&quot;</span><br><span class="line">        &#125;)</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>
<p>这里是唯一的一次书写new运算符。这是vue的语法，因为vue是一个构造函数，注意它并不是组件的构造函数，就是启动语法而已。</p>
<blockquote>
<p>React中任何一个组件都是一个class(类)，并且这个类继承于React.Component。当你放标签的时候，相当于实例化了这个类。<br>Vue也是一样，任何一个组件也是一个类。但Vue有一个非常大的特点：++语法隐藏底层细节++</p>
</blockquote>
<h3 id="三、MVVM特性"><a href="#三、MVVM特性" class="headerlink" title="三、MVVM特性"></a>三、MVVM特性</h3><ol>
<li><p>清单式语法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">        &lt;h1&gt;&#123;&#123;a&#125;&#125;&lt;/h1&gt;</span><br><span class="line">        &lt;button @click=&quot;add()&quot;&gt;按我+1&lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;script type=&quot;text/javascript&quot; src=&quot;./jslib/vue.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        new Vue(&#123;</span><br><span class="line">            // 运行点</span><br><span class="line">            el : &quot;#app&quot;,</span><br><span class="line">            // 数据</span><br><span class="line">            data: &#123;</span><br><span class="line">                a : 100</span><br><span class="line">            &#125;</span><br><span class="line">            // 方法</span><br><span class="line">            methods: &#123;</span><br><span class="line">                add()&#123;</span><br><span class="line">                    this.a++</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>双向绑定机理</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        var obj = &#123;</span><br><span class="line">            a : 8</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        Object.defineProperties(obj, &#123;</span><br><span class="line">            &quot;a&quot; : &#123;</span><br><span class="line">                set()&#123;</span><br><span class="line">                    alert(&quot;改了！快通知视图跟着变！&quot;)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="四、指令"><a href="#四、指令" class="headerlink" title="四、指令"></a>四、指令</h3><blockquote>
<p>指令，即标签身上的属性，只是这些属性有特殊性、功能性</p>
</blockquote>
<ol>
<li>v-if和v-show</li>
</ol>
<ul>
<li>v-if决定元素是否上树</li>
<li>v-show决定元素是否显示</li>
</ul>
<blockquote>
<p>如果需要触发组件的生命周期钩子函数，此时让组件携带v-if，反之用v-show</p>
</blockquote>
<ol>
<li>v-for：用来实现循环某个节点，循环节点必须绑key<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;ul&gt;</span><br><span class="line">    &lt;li v-for=&quot;(item, index) in arr&quot; v-bind:key=&quot;index&quot;&gt;</span><br><span class="line">        &#123;&#123; index &#125;&#125; - &#123;&#123; item &#125;&#125;</span><br><span class="line">    &lt;/li&gt;</span><br><span class="line">&lt;/ul&gt;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>特别的，可以循环自然数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;p v-for=&quot;item in 5&quot;&gt;&#123;&#123; item &#125;&#125;&lt;/p&gt;</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>99乘法表</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;table&gt;</span><br><span class="line">    &lt;tr v-for=&quot;i in 9&quot;&gt;</span><br><span class="line">        &lt;td v-for=&quot;j in 9&quot;&gt;</span><br><span class="line">            &lt;span v-show=&quot;i&gt;=j&quot;&gt;</span><br><span class="line">                &#123;&#123; i &#125;&#125; * &#123;&#123; j &#125;&#125; = &#123;&#123; i*j &#125;&#125;</span><br><span class="line">            &lt;/span&gt;</span><br><span class="line">        &lt;/td&gt;</span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">&lt;/table&gt;</span><br></pre></td></tr></table></figure>
<ol>
<li>v-bind(==重难点==)</li>
</ol>
<blockquote>
<p>v-bind指令可以让任何W3C属性变“动态”。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">        &lt;input tyoe=&quot;text&quot; v-bind:value=&quot;a&quot; /&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;script type=&quot;text/javascript&quot; src=&quot;./jslib/vue.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        new Vue(&#123;</span><br><span class="line">            el : &quot;#app&quot;,</span><br><span class="line">            data: &#123;</span><br><span class="line">                a : 100</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意：v-bind:xxx=”…” 冒号里面已经是动态的了，所以在里面的写法要和js语法保持一致！特别注意连字符！</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;input tyoe=&quot;text&quot; v-bind:value=&quot;a&quot; /&gt;</span><br><span class="line">&lt;input tyoe=&quot;text&quot; v-bind:value=&quot;3+5&quot; /&gt;</span><br><span class="line">&lt;input tyoe=&quot;text&quot; v-bind:value=&quot;&apos;./images/&apos; + a + &apos;.jpg&apos;&quot; /&gt;</span><br><span class="line">&lt;input tyoe=&quot;text&quot; v-bind:value=&quot;`./images/$&#123;a&#125;.jpg`&quot; /&gt;</span><br></pre></td></tr></table></figure>
<ol>
<li>v-on：事件监听 </li>
<li>v-model：双向绑定</li>
</ol>
<blockquote>
<p>调色板案例</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span><br><span class="line">    &lt;title&gt;调色板&lt;/title&gt;</span><br><span class="line">    &lt;style&gt;</span><br><span class="line">        .box&#123;width: 200px; height: 200px; border: 1px solid #000;&#125;</span><br><span class="line">    &lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;box&quot; :style=&quot;`background-color:rgb($&#123;r&#125;,$&#123;g&#125;,$&#123;b&#125;)`&quot;&gt;&lt;/div&gt;</span><br><span class="line">        &lt;p&gt;</span><br><span class="line">            &lt;input type=&quot;range&quot; :min=&quot;0&quot; :max=&quot;255&quot; v-model=&quot;r&quot; /&gt;</span><br><span class="line">            &lt;input type=&quot;number&quot; :min=&quot;0&quot; :max=&quot;255&quot; v-model=&quot;r&quot; /&gt;</span><br><span class="line">            &#123;&#123; r &#125;&#125;</span><br><span class="line">        &lt;/p&gt;</span><br><span class="line">        &lt;p&gt;</span><br><span class="line">            &lt;input type=&quot;range&quot; :min=&quot;0&quot; :max=&quot;255&quot; v-model=&quot;g&quot; /&gt;</span><br><span class="line">            &lt;input type=&quot;number&quot; :min=&quot;0&quot; :max=&quot;255&quot; v-model=&quot;g&quot; /&gt;</span><br><span class="line">            &#123;&#123; g &#125;&#125;</span><br><span class="line">        &lt;/p&gt;</span><br><span class="line">        &lt;p&gt;</span><br><span class="line">            &lt;input type=&quot;range&quot; :min=&quot;0&quot; :max=&quot;255&quot; v-model=&quot;b&quot; /&gt;</span><br><span class="line">            &lt;input type=&quot;number&quot; :min=&quot;0&quot; :max=&quot;255&quot; v-model=&quot;b&quot; /&gt;</span><br><span class="line">            &#123;&#123; b &#125;&#125;</span><br><span class="line">        &lt;/p&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">    &lt;script type=&quot;text/javascript&quot; src=&quot;jslib/vue.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">        new Vue(&#123;</span><br><span class="line">            el : &quot;#app&quot;,</span><br><span class="line">            data : &#123;</span><br><span class="line">                r : 100,</span><br><span class="line">                g : 200,</span><br><span class="line">                b : 123</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<ol>
<li>computed和methods</li>
</ol>

      
    </div>
    
    
    

    

    

    
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者：</strong>
    万俟逍
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="KevinBlack.github.io/8d969c4d.html" title="爱前端笔记">KevinBlack.github.io/8d969c4d.html</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>
    本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> 许可协议。转载请注明出处！
  </li>
</ul>

      </div>
    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/a9840e73.html" rel="next" title="JavaScript复习">
                <i class="fa fa-chevron-left"></i> JavaScript复习
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/8d969c4d.html" rel="prev" title="各种报错">
                各种报错 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
      <div id="sidebar-dimmer"></div>
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/img/avatar.jpg"
                alt="万俟逍" />
            
              <p class="site-author-name" itemprop="name">万俟逍</p>
              <p class="site-description motion-element" itemprop="description">涅槃之路，向死而生</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">19</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">11</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#目录"><span class="nav-number">1.</span> <span class="nav-text">目录</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#canvas"><span class="nav-number">1.1.</span> <span class="nav-text">canvas</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#一-canvas的基本使用"><span class="nav-number">1.1.1.</span> <span class="nav-text">一. canvas的基本使用</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#nodeJS"><span class="nav-number">1.2.</span> <span class="nav-text">nodeJS</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#开门注"><span class="nav-number">1.2.1.</span> <span class="nav-text">开门注</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-JavaScript到底出了什么问题？"><span class="nav-number">1.2.1.1.</span> <span class="nav-text">1. JavaScript到底出了什么问题？</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-Node-js创建服务器-node-js"><span class="nav-number">1.2.1.2.</span> <span class="nav-text">2. Node.js创建服务器(node.js)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-Node-js的特点："><span class="nav-number">1.2.1.3.</span> <span class="nav-text">3. Node.js的特点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-路由机制"><span class="nav-number">1.2.1.4.</span> <span class="nav-text">4. 路由机制</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-模块"><span class="nav-number">1.2.1.5.</span> <span class="nav-text">5. 模块</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-作用域和暴露"><span class="nav-number">1.2.1.6.</span> <span class="nav-text">6. 作用域和暴露</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-神奇的node-modules文件夹"><span class="nav-number">1.2.1.7.</span> <span class="nav-text">7. 神奇的node_modules文件夹</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#8-npm的世界"><span class="nav-number">1.2.1.8.</span> <span class="nav-text">8. npm的世界</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#9-GET和POST请求"><span class="nav-number">1.2.1.9.</span> <span class="nav-text">9. GET和POST请求</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#10-formidable模块：npm上可以下载一个formidable的模块，用来处理post请求。甚至可以处理图片、zip文件等的上传。"><span class="nav-number">1.2.1.10.</span> <span class="nav-text">10. formidable模块：npm上可以下载一个formidable的模块，用来处理post请求。甚至可以处理图片、zip文件等的上传。</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#11-Express-js框架："><span class="nav-number">1.2.1.11.</span> <span class="nav-text">11. Express.js框架：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#12-模板引擎：express可以象PHP一样使用后台语言模板，此时最好用的模板引擎叫做ejs模板引擎。"><span class="nav-number">1.2.1.12.</span> <span class="nav-text">12. 模板引擎：express可以象PHP一样使用后台语言模板，此时最好用的模板引擎叫做ejs模板引擎。</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#13-MVC设计模式："><span class="nav-number">1.2.1.13.</span> <span class="nav-text">13. MVC设计模式：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#14-MongoDB芒果数据库"><span class="nav-number">1.2.1.14.</span> <span class="nav-text">14. MongoDB芒果数据库</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#15-Node-js和MongoDB的连接"><span class="nav-number">1.2.1.15.</span> <span class="nav-text">15. Node.js和MongoDB的连接</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#16-MongoDB"><span class="nav-number">1.2.1.16.</span> <span class="nav-text">16. MongoDB</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#React"><span class="nav-number">1.3.</span> <span class="nav-text">React</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Vue"><span class="nav-number">1.4.</span> <span class="nav-text">Vue</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#一、简介"><span class="nav-number">1.4.1.</span> <span class="nav-text">一、简介</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#二、启动"><span class="nav-number">1.4.2.</span> <span class="nav-text">二、启动</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#三、MVVM特性"><span class="nav-number">1.4.3.</span> <span class="nav-text">三、MVVM特性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#四、指令"><span class="nav-number">1.4.4.</span> <span class="nav-text">四、指令</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">万俟逍</span>

  
</div>


<!--
  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div>
-->




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  

</body>
</html>
